!function(e){"use strict";const s=function(s){this.$video=e(s),this.$wrapper=e(s).parent().addClass("paused"),this.$controls=this.$wrapper.find(".video-controls"),this.$video.removeAttr("controls"),this.$video.attr("autoplay")&&this.$wrapper.removeClass("paused").addClass("playing"),"true"!==this.$video.attr("muted")&&0!==this.$video[0].volume||(this.$video[0].muted=!0,this.$wrapper.addClass("muted")),this.attachEvents()};s.prototype.attachEvents=function(){var s,t=this;this.$wrapper.on("click","[data-media]",function(s){s.stopPropagation();var i=e(this).data("media");"play-pause"===i&&t.playPause(),"mute-unmute"===i&&t.muteUnmute()}),this.$video.on("play",function(e){e.stopPropagation(),t.$wrapper.removeClass("paused").addClass("playing")}),this.$video.on("pause",function(e){e.stopPropagation(),t.$wrapper.removeClass("playing").addClass("paused")}),this.$video.on("volumechange",function(s){s.stopPropagation(),e(this)[0].muted?t.$wrapper.addClass("muted"):t.$wrapper.removeClass("muted")}),this.$wrapper.on("mousemove",function(){t.$controls.addClass("video-controls--show"),clearTimeout(s),s=setTimeout(function(){t.$controls.removeClass("video-controls--show")},2250)}).on("mouseleave",function(){t.$controls.removeClass("video-controls--show")})},s.prototype.playPause=function(){this.$video[0].paused?this.$video[0].play():this.$video[0].pause()},s.prototype.muteUnmute=function(){!1===this.$video[0].muted?this.$video[0].muted=!0:this.$video[0].muted=!1},e.fn.WpsfMyStream=function(){const t=e(this),i=t.data("ajax-url"),o=t.data("nonce"),n=t.data("stream-id"),a=t.data("stream-options");let r,p,l,c,d,u,f,w,m,h,v,g,b,y;if(this.isValidStream=(()=>"object"==typeof a&&void 0!==n&&void 0!==o&&void 0!==i),!this.isValidStream())return!1;function x(e,s){let t;return s=s||100,function(){clearTimeout(t);const i=arguments,o=this;t=setTimeout(function(){e.apply(o,i)},s)}}function C(e){var s="";for(var t in e)s+=e[t];return s}r=a.general.postSettings.template,p=a.general.postSettings.layout,l=a.general.postCount,w=t.find(".wpsf-stream-wrapper-loader"),m=t.find(".wpsf-load-more-button > button"),h=t.find(".wpsf-stream-searchbox-container .wpsf-stream-searchbox input"),v=t.find(".wpsf-filter .wpsf-filter-simple"),c="carousel"==p?t.find(`#wpsf-swiper-wrapper-${n}`):t.find(`#wpsf-row-${n}`);const $=()=>{g=!0;let s,t,i,o={};const l={masonry:"masonry",wall:"vertical",gird:"fitRows",justified:"fitRows",default:"masonry"};c.isotope({itemSelector:`#wpsf-stream-${n} .wpsf-${r}-feed-box`,resizesContainer:!0,stagger:70,transitionDuration:parseInt(a.general.feedLoadWithAnimation)?"0.4s":0,containerStyle:{position:"relative",overflow:"visible"},layoutMode:l[p]?l[p]:l.default,equalheight:!0,percentPosition:!0,vertical:{horizontalAlignment:.5},filter:function(){const o=e(this);s&&o.highlight(s);const n=!t||o.text().match(t),a=!i||o.is(i);return n&&a}}),h.on("keyup",x(function(){s=this.value,t=new RegExp(s,"gi"),c.removeHighlight(),c.isotope()},250)),v.find("span").on("click",x(function(){const s=e(this);v.find("span").removeClass("active"),s.addClass("active");const t=s.parents(".wpsf-filter-group").attr("data-filter-group");o[t]=s.attr("data-filter"),i=C(o),c.isotope()},200))},P=()=>{b=!0;let s=!0;const t=e(`#wpsf-stream-${n} #wpsf-swiper-container-${n}`);f=new Swiper(t,{slidesPerView:parseInt(a.carousel.responsive.mobile.column),slidesPerColumn:parseInt(a.carousel.responsive.mobile.row),spaceBetween:parseInt(a.carousel.responsive.mobile.gap),slidesPerGroup:a.carousel.maxItemPerSlide?parseInt(a.carousel.responsive.mobile.column):1,slidesPerColumnFill:"row",observer:!0,observeParents:!0,speed:parseInt(a.carousel.sliderControls.slideSwitchSpeed),followFinger:!!a.carousel.sliderControls.dragControl,simulateTouch:!!a.carousel.sliderControls.dragControl,breakpointsInverse:!0,autoplay:!(Number(a.carousel.sliderControls.autoPlaySpeed)<1)&&{delay:Number(a.carousel.sliderControls.autoPlaySpeed)},on:{observerUpdate:x(function(){this.updateSlides()},500),sliderMove:x(function(){s=!1},500)},pagination:{el:`#wpsf-stream-${n} #wpsf-swiper-container-${n} #wpsf-swiper-pagination-${n}`,clickable:!0},navigation:{nextEl:`#wpsf-stream-${n} #wpsf-swiper-container-${n} #wpsf-swiper-next-${n}`,prevEl:`#wpsf-stream-${n} #wpsf-swiper-container-${n} #wpsf-swiper-prev-${n}`},breakpoints:{576:{slidesPerView:parseInt(a.carousel.responsive.mobile.column),slidesPerColumn:parseInt(a.carousel.responsive.mobile.row),spaceBetween:parseInt(a.carousel.responsive.mobile.gap),slidesPerGroup:a.carousel.maxItemPerSlide?parseInt(a.carousel.responsive.mobile.column):1},768:{slidesPerView:parseInt(a.carousel.responsive.tablet.column),slidesPerColumn:parseInt(a.carousel.responsive.tablet.row),spaceBetween:parseInt(a.carousel.responsive.tablet.gap),slidesPerGroup:a.carousel.maxItemPerSlide?parseInt(a.carousel.responsive.tablet.column):1},1200:{slidesPerView:parseInt(a.carousel.responsive.desktop.column),slidesPerColumn:parseInt(a.carousel.responsive.desktop.row),spaceBetween:parseInt(a.carousel.responsive.desktop.gap),slidesPerGroup:a.carousel.maxItemPerSlide?parseInt(a.carousel.responsive.desktop.column):1}}}),parseInt(a.carousel.sliderControls.autoPlaySpeed)>0&&(t.on("mouseenter",x(function(){s&&f.autoplay.running&&f.autoplay.stop()},500)),t.on("mouseleave",x(function(){s&&!f.autoplay.running&&f.autoplay.start()},500))),t.show()},I=()=>{u.find("video").each(function(){this.pause(),this.currentTime=0}),e("html").css("overflow",""),e("body").css("overflow",""),u.removeClass("wpsf-popup-open")},k=()=>{e("body").append(`<div id="wpsf-popup-${n}" class="wpsf-popup">\n            <div class="wpsf-popup-container swiper-container">\n                <div class="wpsf-popup-wrapper swiper-wrapper"></div>\n                \x3c!-- Navigation --\x3e\n                <div class="wpsf-popup-next-item swiper-button-next swiper-button-white"></div>\n                <div class="wpsf-popup-prev-item swiper-button-prev swiper-button-white"></div>\n            </div>\n            <div class="wpsf-close-popup-container">\n                <button class="wpsf-close-popup">\n                    <i class='lni lni-close'></i>\n                </button>\n            </div>\n        </div>`),d=e(`#wpsf-popup-${n} .wpsf-popup-container`),(u=e(d.closest(".wpsf-popup"))).on("click",x(function(s){const t=u.find(".wpsf-popup-item.swiper-slide-active > .wpsf-popup-item-container"),i=e(s.target);t.is(i)||i.hasClass("wpsf-popup-next-item")||i.hasClass("wpsf-popup-prev-item")||0!==t.has(i).length||!u.hasClass("wpsf-popup-open")||I()},200)),e(document).on("keydown",x(function(e){27==e.keyCode&&u.hasClass("wpsf-popup-open")&&I()},200)),u.find(".wpsf-close-popup-container .wpsf-close-popup > i").on("click",function(){I()}),u.on("click",".wpsf-popup-item-header-dropdown-share-links",function(){u.find(".wpsf-popup-item-header-share-links").toggleClass("show-share-links")}),d=new Swiper(d,{navigation:{nextEl:d.find(".wpsf-popup-next-item"),prevEl:d.find(".wpsf-popup-prev-item")},allowTouchMove:!1,on:{slideChange:()=>{e(this).find("video").each(function(){this.pause(),this.currentTime=0})}}})},S=()=>{let s,t,i,o={};const n={1:"nojustify",2:"justify",3:"hide"};y={selector:".wpsf-tile-feed-box",rowHeight:a.justified.rowHeight,lastRow:n[a.justified.lastRow]?n[a.justified.lastRow]:n[2],margins:a.justified.margins,imgSelector:"> .wpsf-tile-feed-box-container .wpsf-tile-feed-box-content-img img.wpsf-lazy-img, > a > img"},c.justifiedGallery(y);const r=()=>{c.justifiedGallery({filter:function(o,n,a){const r=e(o);s&&r.highlight(s);const p=!t||r.text().match(t),l=!i||r.is(i);return p&&l}})};h.on("keyup",x(function(){s=this.value,t=new RegExp(s,"gi"),c.removeHighlight(),r()},250)),v.find("span").on("click",x(function(){const s=e(this);v.find("span").removeClass("active"),s.addClass("active");const t=s.parents(".wpsf-filter-group").attr("data-filter-group");o[t]=s.attr("data-filter"),i=C(o),r()},200))},j=(e=200)=>{setTimeout(()=>{c.isotope("layout")},e)},T=s=>new Promise(t=>{!async function(){for(let t=0;t<s.length;t++){const i=e(s[t]),o="classic"==r?i.find(".wpsf-classic-feed-box-content"):i.find(".wpsf-tile-feed-box-content-img > div");if("tile"==r){const e=i.width();o.height(e),o.width(e),i.height(e)}else{const e=i.find(".wpsf-classic-feed-box-meta").height(),s=i.find(".wpsf-classic-feed-box-content-text").height(),t=i.width()+e+s,o=i.width()>=400?75*t/100:60*t/100;i.find(".wpsf-classic-feed-box-content-img div").height(o),i.width()<=400&&a.general.postSettings.displayPostElements.text&&i.find(".wpsf-classic-feed-box-content").css("padding-bottom","15px")}}t(s)}()}),E=(s,t=200)=>{d.slideTo((s=>{let t=1;return d.slides.each(function(i,o){e(o).data("id")==s&&(t=i)}),t})(s),t,!1),setTimeout(()=>{e("html").css("overflow","hidden"),e("body").css("overflow","hidden"),e(`#wpsf-popup-${n}`).addClass("wpsf-popup-open")},200)},z=()=>{if("carousel"==p&&(f.isEnd&&f.slideTo(1,300),f.params.slidesPerColumn>1)){(s=>{e.each(s,function(s,t){const i=e(t);i.css("margin-top",i.css("margin-right"))})})("classic"==r?c.find(".wpsf-classic-feed-box"):c.find(".wpsf-tile-feed-box"))}"grid"!=p&&"carousel"!=p||(e(window).on("resize",x(function(){const e="classic"==r?c.find(".wpsf-classic-feed-box"):c.find(".wpsf-tile-feed-box");T(e).then(()=>{"grid"==p&&j(200)})},900)),e(window).trigger("resize"))},G=e=>(e.find(".wpsf-lazy-img").lazy({onError:function(e){e.addClass("wpsf-failure-img-load")},afterLoad:function(e){e.removeClass("wpsf-lazy-img-loading")},onFinishedAll:function(){"justified"==p&&setTimeout(()=>{c.justifiedGallery("norewind")},2e3),g&&j(400)}}),e.find("video").lazy({onFinishedAll:function(){g&&j(400)}}),e),R=e=>(e.find("video").each(function(){new s(this)}),e),A=s=>{return("classic"==r?s.find(".wpsf-classic-feed-box-share-meta i.lni-exit-up"):s.find(".wpsf-tile-feed-box-overlay-share-meta i.lni-exit-up")).on("click",function(s){s.stopPropagation(),e(this).prev().toggleClass("show-share-links")}),Promise.resolve(s)},F=e=>new Promise(s=>{A(e).then(e=>{(e=>{const s=a.general.actionOnImageClick;if(e.find("a:not([data-lightbox])").on("click",function(e){e.stopPropagation()}),1==s){const s=e.data("id");("classic"==r?e.find(".wpsf-classic-feed-box-media-wrapper"):e.find(".wpsf-tile-feed-box-overlay")).on("click",function(){E(s,400)})}else"tile"!=r||3!=s&&4!=s||e.find(".wpsf-tile-feed-box-overlay").on("click",()=>{e.find(".wpsf-tile-feed-box-content-img > a")[0].click()});return Promise.resolve(e)})(e).then(e=>{s(e)})})}),V=s=>(e(s).find(".swiper-container").each(function(){const s=e(this);new Swiper(this,{pagination:{el:e(this).find(".swiper-pagination"),type:"bullets"},navigation:{nextEl:s.find(".wpsf-media-next-item"),prevEl:s.find(".wpsf-media-prev-item")},observer:!0,observeParents:!0,on:{slideChange:()=>{e(this).find("video").each(function(){this.pause(),this.currentTime=0})}}})}),Promise.resolve(s)),M=(s,t)=>new Promise((a,r)=>{e.ajax({url:i,type:"get",beforeSend:()=>{m.hide(),w.show()},data:{action:"wpsf_get_stream_posts",stream:parseInt(n),count:parseInt(t),page:parseInt(s),nonce:o}}).done(e=>{(null==e.items||e.count<1)&&r([]),a(e.items)}).fail(e=>{r(e)})}),B=async(e,s)=>{const t=e.item.media_type,i=await G(s),o=await R(i),n=await F(o);return"wall"!=p||"sidecar"!=t&&"carousel"!=t?n:V(n)},H=async(e,s)=>{const t=await G(s),i=await R(t);return V(i)},N=s=>{const t=e(document.createDocumentFragment()),i=e(document.createDocumentFragment());return new Promise(async o=>{const n=async function(e,s){"carousel"==p?await(e=>{const s=e.children();return new Promise(e=>{s.css({visibility:"hidden",height:"0"}),f.appendSlide(s),setTimeout(()=>{T(s).then(()=>{s.css({visibility:"visible",height:""}),e()})},100)})})(e):"grid"==p?await(e=>new Promise(s=>{const t=e.children();t.css("visibility","hidden"),c.append(t),T(t).then(()=>{c.isotope("appended",t).isotope("layout"),t.css("visibility","visible"),s()})}))(e):"justified"==p?await(e=>new Promise(s=>{const t=e.children();c.append(t),s()}))(e):await(e=>new Promise(s=>{const t=e.children();c.append(t).isotope("appended",t).isotope("layout"),s()}))(e),s.children().length&&await d.appendSlide(s)};!async function(){for(let o=0;o<s.length;o++){const n=s[o],a=e(n.content),r=e(n.popup),p=await B(n,a);if(t.append(p),r.length){const e=await H(0,r);i.append(e)}}await n(t,i),o()}()})};M(1,l).then(s=>{"carousel"==p?P():"justified"==p?S():$(),1!=a.general.actionOnImageClick&&2!=a.general.actionOnImageClick||k(),N(s).then(()=>{w.hide(),m.show(),m.on("click",()=>{m.hide(),w.show();const s=m.data("page");M(s,l).then(e=>{N(e).then(()=>{m.data("page",s+1),m.show(),w.hide()})}).catch(()=>{w.remove(),m.replaceWith(e("p").contentText="No More Item Available")})}),z()})}).catch(()=>{w.hide(),m.hide()})}}(jQuery);